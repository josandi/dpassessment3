<div class="dpa-modal container-fluid">
  <form #questionnaireAddForm="ngForm" (ngSubmit)="submitQuestionnaire()"
    class="dpa-modal-form" role="form">
    <div class="row">
        <div class="col-md-12">
          <label for="questionnaireName" class="dpa-label"> Questionnaire Description </label>
          <input type="text" name="questionnaireName" [(ngModel)]="questionnaire.questionaireDescription"
            class="form-control" required />
        </div>
      <div class="col-md-12">
        <label for="instructions" class="dpa-label"> Instructions </label>
        <textarea type="text" name="instructions" [(ngModel)]="questionnaire.questionaireInstructions"
          class="form-control" required ></textarea>
      </div>
    </div>

    <div class="modal-divider"></div>

    <div class="row">
      <div class="col-md-12">
        <label for="description" class="dpa-label">
          New Question
          <span class="dpa-field-error" *ngIf="!questionFldsValid">
              *All fields are required.
          </span>
        </label>
        <textarea type="text" name="description" id="newquestion" 
          [(ngModel)]="question.description" class="form-control" ></textarea>
      </div>
      <div class="col-md-6">
        <select class="form-control" [(ngModel)]="question.selectedCategory" name="questionCategory">
          <option *ngFor="let qstCategory of questionCategories" [ngValue]="qstCategory">
            {{ qstCategory.questionCategoryDesc }}
          </option>
        </select>  
      </div>
      <div class="col-md-6">
        <select class="form-control" [(ngModel)]="question.selectedOptGroup" name="questionOptGroup">
          <option *ngFor="let optGroup of questionOptGroups" [ngValue]="optGroup">
            {{ optGroup.optionGroupDesc }}
          </option>
        </select>  
      </div>
      <div class="col-md-12 pull-right">
        <button type="button" class="btn dpabtn-yellow col-md-4 pull-right" (click)="addQuestion()">
          Add Question
        </button>
      </div>
    </div>

    <div class="modal-divider"></div>

    <div class="row pre-scrollable qst-questions">
      <fieldset  ng-disabled="true">
        <div *ngFor="let category of categories" class="qst-category">
            <div class="dpa-label">{{ category.questionCategoryDesc }}</div>
            <ol>
              <li *ngFor="let question of questionnaire.questionWithOptions 
                | questionCategoryFilter:category.questionCategoryId">
                <div class="qst-question col-md-12">
                  <span class="pull-right">
                    <a class="pointer-cursor" (click)="removeQuestion(question)">
                      <i class="fa fa-times"></i>
                    </a>
                  </span>
                  {{ question.questionDescription }}
                </div>
                <div class="qst-answer" >
                  <div class="col-md-12 qst-options" *ngIf="arrayHasData(question.options)">
                    <label *ngFor="let option of question.options">
                      <input type="radio" name="qstopt-{{question.questionId}}"
                        [(ngModel)]="question.answer" [value]="option.optionDescription"/>
                        {{option.optionDescription}}
                    </label>
                  </div>
                  <div class="col-md-12 qst-field" *ngIf="!arrayHasData(question.options)">
                    <textarea ng-model="question.answer" class="form-control" 
                      rows="3" id="answer">
                    </textarea>
                  </div>
                </div>
              </li>
            </ol>
        </div>
      </fieldset>
    </div>

    <div class="row modal-footer">          
        <button type="button" class="btn btn-default col-md-4" (click)="bsModalRef.hide()">
            Cancel
        </button>
        <button type="submit" class="btn btn-warning col-md-4" [disabled]="!questionnaireAddForm.valid">
            {{btnSubmitName}} 
        </button>  
    </div>
  </form>
</div>